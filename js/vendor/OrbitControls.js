THREE.OrbitControls=function(a,b){function E(){return 2*Math.PI/60/60*c.autoRotateSpeed}function F(){return Math.pow(.95,c.zoomSpeed)}function G(a){if(c.enabled!==!1){if(a.preventDefault(),a.button===c.mouseButtons.ORBIT){if(c.noRotate===!0)return;y=x.ROTATE,e.set(a.clientX,a.clientY)}else if(a.button===c.mouseButtons.ZOOM){if(c.noZoom===!0)return;y=x.DOLLY,m.set(a.clientX,a.clientY)}else if(a.button===c.mouseButtons.PAN){if(c.noPan===!0)return;y=x.PAN,h.set(a.clientX,a.clientY)}y!==x.NONE&&(document.addEventListener("mousemove",H,!1),document.addEventListener("mouseup",I,!1),c.dispatchEvent(C))}}function H(a){if(c.enabled!==!1){a.preventDefault();var b=c.domElement===document?c.domElement.body:c.domElement;if(y===x.ROTATE){if(c.noRotate===!0)return;f.set(a.clientX,a.clientY),g.subVectors(f,e),c.rotateLeft(2*Math.PI*g.x/b.clientWidth*c.rotateSpeed),c.rotateUp(2*Math.PI*g.y/b.clientHeight*c.rotateSpeed),e.copy(f)}else if(y===x.DOLLY){if(c.noZoom===!0)return;n.set(a.clientX,a.clientY),o.subVectors(n,m),o.y>0?c.dollyIn():c.dollyOut(),m.copy(n)}else if(y===x.PAN){if(c.noPan===!0)return;i.set(a.clientX,a.clientY),j.subVectors(i,h),c.pan(j.x,j.y),h.copy(i)}y!==x.NONE&&c.update()}}function I(){c.enabled!==!1&&(document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",I,!1),c.dispatchEvent(D),y=x.NONE)}function J(a){if(c.enabled!==!1&&c.noZoom!==!0&&y===x.NONE){a.preventDefault(),a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail),b>0?c.dollyOut():c.dollyIn(),c.update(),c.dispatchEvent(C),c.dispatchEvent(D)}}function K(a){if(c.enabled!==!1&&c.noKeys!==!0&&c.noPan!==!0)switch(a.keyCode){case c.keys.UP:c.pan(0,c.keyPanSpeed),c.update();break;case c.keys.BOTTOM:c.pan(0,-c.keyPanSpeed),c.update();break;case c.keys.LEFT:c.pan(c.keyPanSpeed,0),c.update();break;case c.keys.RIGHT:c.pan(-c.keyPanSpeed,0),c.update()}}function L(a){if(c.enabled!==!1){switch(a.touches.length){case 1:if(c.noRotate===!0)return;y=x.TOUCH_ROTATE,e.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(c.noZoom===!0)return;y=x.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX,d=a.touches[0].pageY-a.touches[1].pageY,f=Math.sqrt(b*b+d*d);m.set(0,f);break;case 3:if(c.noPan===!0)return;y=x.TOUCH_PAN,h.set(a.touches[0].pageX,a.touches[0].pageY);break;default:y=x.NONE}y!==x.NONE&&c.dispatchEvent(C)}}function M(a){if(c.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=c.domElement===document?c.domElement.body:c.domElement;switch(a.touches.length){case 1:if(c.noRotate===!0)return;if(y!==x.TOUCH_ROTATE)return;f.set(a.touches[0].pageX,a.touches[0].pageY),g.subVectors(f,e),c.rotateLeft(2*Math.PI*g.x/b.clientWidth*c.rotateSpeed),c.rotateUp(2*Math.PI*g.y/b.clientHeight*c.rotateSpeed),e.copy(f),c.update();break;case 2:if(c.noZoom===!0)return;if(y!==x.TOUCH_DOLLY)return;var d=a.touches[0].pageX-a.touches[1].pageX,k=a.touches[0].pageY-a.touches[1].pageY,l=Math.sqrt(d*d+k*k);n.set(0,l),o.subVectors(n,m),o.y>0?c.dollyOut():c.dollyIn(),m.copy(n),c.update();break;case 3:if(c.noPan===!0)return;if(y!==x.TOUCH_PAN)return;i.set(a.touches[0].pageX,a.touches[0].pageY),j.subVectors(i,h),c.pan(j.x,j.y),h.copy(i),c.update();break;default:y=x.NONE}}}function N(){c.enabled!==!1&&(c.dispatchEvent(D),y=x.NONE)}this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var p,q,c=this,d=1e-6,e=new THREE.Vector2,f=new THREE.Vector2,g=new THREE.Vector2,h=new THREE.Vector2,i=new THREE.Vector2,j=new THREE.Vector2,k=new THREE.Vector3,l=new THREE.Vector3,m=new THREE.Vector2,n=new THREE.Vector2,o=new THREE.Vector2,r=0,s=0,t=1,u=new THREE.Vector3,v=new THREE.Vector3,w=new THREE.Quaternion,x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},y=x.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var z=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),A=z.clone().inverse(),B={type:"change"},C={type:"start"},D={type:"end"};this.rotateLeft=function(a){void 0===a&&(a=E()),s-=a},this.rotateUp=function(a){void 0===a&&(a=E()),r-=a},this.panLeft=function(a){var b=this.object.matrix.elements;k.set(b[0],b[1],b[2]),k.multiplyScalar(-a),u.add(k)},this.panUp=function(a){var b=this.object.matrix.elements;k.set(b[4],b[5],b[6]),k.multiplyScalar(a),u.add(k)},this.pan=function(a,b){var d=c.domElement===document?c.domElement.body:c.domElement;if(void 0!==c.object.fov){var e=c.object.position,f=e.clone().sub(c.target),g=f.length();g*=Math.tan(c.object.fov/2*Math.PI/180),c.panLeft(2*a*g/d.clientHeight),c.panUp(2*b*g/d.clientHeight)}else void 0!==c.object.top?(c.panLeft(a*(c.object.right-c.object.left)/d.clientWidth),c.panUp(b*(c.object.top-c.object.bottom)/d.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(a){void 0===a&&(a=F()),t/=a},this.dollyOut=function(a){void 0===a&&(a=F()),t*=a},this.update=function(){var a=this.object.position;l.copy(a).sub(this.target),l.applyQuaternion(z),p=Math.atan2(l.x,l.z),q=Math.atan2(Math.sqrt(l.x*l.x+l.z*l.z),l.y),this.autoRotate&&y===x.NONE&&this.rotateLeft(E()),p+=s,q+=r,p=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,p)),q=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,q)),q=Math.max(d,Math.min(Math.PI-d,q));var b=l.length()*t;b=Math.max(this.minDistance,Math.min(this.maxDistance,b)),this.target.add(u),l.x=b*Math.sin(q)*Math.sin(p),l.y=b*Math.cos(q),l.z=b*Math.sin(q)*Math.cos(p),l.applyQuaternion(A),a.copy(this.target).add(l),this.object.lookAt(this.target),s=0,r=0,t=1,u.set(0,0,0),(v.distanceToSquared(this.object.position)>d||8*(1-w.dot(this.object.quaternion))>d)&&(this.dispatchEvent(B),v.copy(this.object.position),w.copy(this.object.quaternion))},this.reset=function(){y=x.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.getPolarAngle=function(){return q},this.getAzimuthalAngle=function(){return p},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",G,!1),this.domElement.addEventListener("mousewheel",J,!1),this.domElement.addEventListener("DOMMouseScroll",J,!1),this.domElement.addEventListener("touchstart",L,!1),this.domElement.addEventListener("touchend",N,!1),this.domElement.addEventListener("touchmove",M,!1),window.addEventListener("keydown",K,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;